@page "/list"
@using System.Text.Json
@inject NavigationManager navigationManager
@inject IJSRuntime JSRuntime
@inject Blazored.LocalStorage.ILocalStorageService LocalStorage
@inject ILocalStorageService LocalStorage

<PageTitle>List Page</PageTitle>


<div class="container">

    <h1 class="p-3 text-center">Star Wars 3 Popular Planets</h1>

    <table class="table table-striped table-bordered">

        <thead>

            <tr>
                <th>Planet Number</th>
                <th>Name</th>
                <th>Image</th>
            </tr>

            <tr>
                <td>#1 <a href="/details">Details</a></td>
                <td><button class="btn btn-primary" @onclick="() =>NavigateToFavourites1()">Tatooine</button></td>
                <td><img src="https://www.denofgeek.com/wp-content/uploads/2021/04/star-wars-tatooine.jpeg" height="100" width="100"></td>
            </tr>

            <tr>
                <td>#2 <a href="/details">Details</a></td>
                <td><button class="btn btn-primary" @onclick="() =>NavigateToFavourites2()">Hoth</button></td>
                <td><img src="https://www.denofgeek.com/wp-content/uploads/2021/04/star-wars-hoth.jpeg" height="100" width="100"></td>
            </tr>

            <tr>
                <td>#3 <a href="/details">Details</a></td>
                <td><button class="btn btn-primary" @onclick="() =>NavigateToFavourites3()">Korriban/Moraband</button></td>
                <td><img src="https://www.denofgeek.com/wp-content/uploads/2021/04/star-wars-korriban.jpg" height="100" width="100"></td>
            </tr>

        </thead>
    </table>
</div>


@code {
    private void NavigateToFavourites1()
    {
        var tableData = new List<Dictionary<string, string>>
        {
            new Dictionary<string, string> {{"Planet Number", "#1"}, {"Name","Tatooine"} }
        };
        
        
            var json = JsonSerializer.Serialize(tableData);
            
            LocalStorage.SetItemAsync("tableData", json); // Store the data in local storage
            
            navigationManager.NavigateTo($"/favourites?tableData={Uri.EscapeDataString(json)}");
        
    }

    private void NavigateToFavourites2()
    {
        var tableData = new List<Dictionary<string, string>>
        {
            new Dictionary<string, string> {{"Planet Number", "#2"}, {"Name","Hoth"} }

        };
        var json = JsonSerializer.Serialize(tableData);
        
        LocalStorage.SetItemAsync("tableData", json); // Store the data in local storage

        navigationManager.NavigateTo($"/favourites?tableData={Uri.EscapeDataString(json)}");
    }

    private void NavigateToFavourites3()
    {
        var tableData = new List<Dictionary<string, string>>
        {
            new Dictionary<string, string> {{"Planet Number", "#3"}, {"Name","Korriban/Moraband"} }

        };
        var json = JsonSerializer.Serialize(tableData);

        LocalStorage.SetItemAsync("tableData", json); // Store the data in local storage

        navigationManager.NavigateTo($"/favourites?tableData={Uri.EscapeDataString(json)}");
    }
}

